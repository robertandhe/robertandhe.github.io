I"Œ'<blockquote>
  <p>logistic regression(LR)å›å½’ä»åå­—ä¸Šçœ‹æ˜¯å›å½’ç®—æ³•ï¼Œä½†å…¶å®æ˜¯ä¸€ä¸ªåˆ†ç±»ç®—æ³•ã€‚æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€å¸¸ç”¨çš„ç®—æ³•ä¹‹ä¸€ã€‚LRå›å½’ç”¨æ¥ä¼°è®¡äº‹ç‰©å‘ç”Ÿçš„æ¦‚ç‡ï¼Œå¦‚ç”¨æˆ·è´­ä¹°å•†å“çš„æ¦‚ç‡ï¼Œå¹¿å‘Šè¢«ç‚¹å‡»çš„æ¦‚ç‡ã€‚</p>
</blockquote>

<h1 id="æ¦‚ç‡é¢„æµ‹é—®é¢˜">æ¦‚ç‡é¢„æµ‹é—®é¢˜</h1>
<p>â€ƒåœ¨çº¿æ€§åˆ¤åˆ«æ¨¡å‹å¦‚PLAä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥é¢„æµ‹æµ‹è¯•æ ·æœ¬æ˜¯pass/fail, positive/negativeï¼Œetcã€‚å‡è®¾ç°åœ¨æƒ³è¦é¢„æµ‹äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡è€Œä¸ä»…ä»…æ˜¯å‘ç”Ÿ
æˆ–è€…ä¸å‘ç”Ÿã€‚ä½†æ˜¯åœ¨è®­ç»ƒæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬åªæœ‰hard binary classificationçš„æ•°æ®é›†ï¼Œå› ä¸ºæ•°æ®æ ‡è®°åªæœ‰å‘ç”Ÿæˆ–ä¸å‘ç”Ÿè€Œä¸æ˜¯å‘ç”Ÿ/ä¸å‘ç”Ÿçš„æ¦‚ç‡ï¼Œæ²¡æœ‰åŠæ³•
ç›´æ¥æ ¹æ®æ¦‚ç‡æ¥å»ºæ¨¡ã€‚æ‰€ä»¥éœ€è¦æ–°çš„æ¨¡å‹æ¥è§£å†³æ¦‚ç‡é¢„æµ‹æ¨¡å‹ã€‚</p>
<h1 id="logisticå›å½’æ¨¡å‹">logisticå›å½’æ¨¡å‹</h1>
<p>â€ƒåœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œç”¨å¯¹æ•°æ¨¡å‹(logit model)æ±‚äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ã€‚ äº‹ä»¶çš„å‡ ç‡ï¼ˆoddsï¼‰æ˜¯$p=P\left({Y=1}\right)$å’Œ$p=P\left( {Y=0}\right)$çš„æ¯”å€¼ã€‚å‡è®¾å¯¹æ•°å‡ ç‡æ˜¯è¾“å…¥çš„çº¿æ€§å‡½æ•°ï¼Œå³</p>

<!-- $$
\log \frac{P\left({Y = 1\left|X\right.}\right)}{1-P\left({Y=1\left|X\right.}\right)} = w^T x
$$ -->

<script type="math/tex; mode=display">\begin{equation}
\log \frac{P\left({Y = 1\left|X\right.}\right)}{1-P\left({Y=1\left|X\right.}\right)} = w^T x
\end{equation}</script>

<p>â€ƒç”±æ­¤å¯æ±‚å‡ºäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸ºï¼š</p>

<script type="math/tex; mode=display">\begin{equation}
P\left( {Y = 1\left| X \right.} \right) = \frac{\exp \left( {w^T x} \right)}{1 + \exp \left( {w^T x} \right)}
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
P\left( {Y = 0\left| X \right.} \right) = \frac{1}{1 + \exp \left( {w^T x} \right)}
\end{equation}</script>

<p>â€ƒè½¬æ¢å¯å¾—ï¼š</p>

<script type="math/tex; mode=display">\begin{equation}
P\left( {Y = 1\left| X \right.} \right) = \frac{1}{1 + \exp \left( { - w^T x} \right)}
\end{equation}</script>

<p>â€ƒä¸Šå¼å³æ˜¯sigmoidå‡½æ•°ï¼Œsigmoidåˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://gitee.com/alston972/MarkDownPhotos/raw/master/2019-10-15/sigmoid.png" alt="sigmoid" height="50%" width="50%" />
â€ƒåœ¨ä¸‹æ–‡ä¸­ï¼Œå‡ç”¨$\theta$è¡¨ç¤ºsigmoidåˆ†å¸ƒï¼Œå³
<script type="math/tex">\theta \left( s \right) = \frac{1}{1 + {e^{ - s}}}</script>
logistic regressionæ¨¡å‹å³æ˜¯ç”¨
$h\left( x \right) = \theta \left( {w^T}x \right) = \frac{1}{1 + \exp \left( { - {w^T}x} \right)}$
è¿‘ä¼¼$P\left( {y = 1\left| x \right.} \right)$ï¼Œäº‹ä»¶å‘ç”Ÿçš„å‡ ç‡è¶Šå¤§ï¼Œ$P\left({Y=1}\right)è¶Šå¤§$ã€‚</p>

<h1 id="ä¸çº¿æ€§å›å½’å…³ç³»">ä¸çº¿æ€§å›å½’å…³ç³»</h1>
<p>é€»è¾‘æ–¯çš„å›å½’ï¼ˆlogistic regressionï¼‰ä¸çº¿æ€§å›å½’ï¼ˆlinear regressionï¼‰éƒ½æ˜¯ä¸€ç§å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆgeneralized linear modelï¼‰ã€‚
LRå›å½’å‡è®¾å› å˜é‡yæœä»ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œçº¿æ€§å›å½’å‡è®¾å› å˜é‡yæœä»é«˜æ–¯åˆ†å¸ƒã€‚å»é™¤sigmoidæ˜ å°„å‡½æ•°ï¼ŒLRç®—æ³•å°±æ˜¯ä¸€ä¸ªçº¿æ€§å›å½’ã€‚</p>

<h1 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h1>
<p>â€ƒæ ¹æ®yæ ‡ç­¾æ˜¯å¦æ˜¯1/-1æˆ–è€…1/0,å­˜åœ¨ä¸¤ç§ä¸åŒå½¢å¼çš„æŸå¤±å‡½æ•°ã€‚ç¬¬ä¸€ç§æ˜¯æ¥è‡ªæèˆªçš„ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ï¼Œç¬¬äºŒç§æ˜¯æ¥è‡ªæ—è½©ç”°è€å¸ˆçš„æœºå™¨å­¦ä¹ åŸºçŸ³ã€‚</p>
<h3 id="ç¬¬ä¸€ç§æŸå¤±å‡½æ•°">ç¬¬ä¸€ç§æŸå¤±å‡½æ•°</h3>
<p>â€ƒåœ¨è¿™é‡Œè®¾æ ‡ç­¾å–å€¼ä¸º1/0ï¼Œè®¾ï¼š$P\left( {y = 1\left| x \right.} \right) = \pi \left( x \right),â€ƒP\left( {y = 0\left| x \right.} \right) = 1 - \pi \left( x \right)$ã€‚è®¾ç»™å®šæ•°æ®é›†$T={\left( {x_1},{y_1} \right),\left( {x_2},{y_2} \right),â€¦,\left( {x_N},{y_N} \right)}$ã€‚ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•ä¼°è®¡æ¨¡å‹å‚æ•°ï¼Œä»è€Œå¾—åˆ°é€»è¾‘æ–¯è’‚å›å½’æ¨¡å‹ã€‚<br />
â€ƒä¼¼ç„¶å‡½æ•°ä¸º</p>

<script type="math/tex; mode=display">\begin{equation}
\prod\limits_{i = 1}^N {
{[{\pi \left( {x_i} \right)}]}^{y_i}
{\left[ {1 - \pi \left( {x_i} \right)} \right]}^{1 - {y_i}}
}
\end{equation}</script>

<p>â€ƒå¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸º</p>

<!-- \begin{align} å…¬å¼æ— ç¼–å·-->

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
L\left( w \right) &= \sum\limits_{i = 1}^N {\left[ {y_i}\log \pi \left( {x_i} \right) + \left( {1 - {y_i}} \right)\log \left( 1 - \pi \left( {x_i} \right) \right) \right]}\\
&= \sum\limits_{i = 1}^N {\left[ {y_i}\log \frac{\pi \left( {x_i} \right)}{1 - \pi \left( {x_i} \right)} + \log \left( {1 - \pi \left( {x_i} \right)} \right) \right]}\\
&= \sum\limits_{i = 1}^N {\left[ {y_i}\left( {w \cdot {x_i}} \right) - \log \left( {1 + \exp \left( {w^T {x_i}} \right)}\right)\right]}
\end{align} %]]></script>

<p>â€ƒä¼¼ç„¶å‡½æ•°çš„åå³ä¸ºæŸå¤±å‡½æ•°</p>

<script type="math/tex; mode=display">\begin{equation}
E\left( w \right) = \sum\limits_{i = 1}^N {\left[ {\log \left( {1 + \exp \left( {w^T {x_i}} \right)} \right) - {y_i}\left( {w^T {x_i}} \right)} \right]}
\end{equation}</script>

<h3 id="ç¬¬äºŒç§æŸå¤±å‡½æ•°">ç¬¬äºŒç§æŸå¤±å‡½æ•°</h3>
<p>â€ƒåœ¨è¿™é‡Œè®¾æ ‡ç­¾ä¸º1/-1ã€‚ç”±logisticå‡½æ•°æ€§è´¨ï¼Œ$P\left( {y =  - 1\left| x \right.} \right) = 1 - P\left( {y = 1\left| x \right.} \right) = 1 - h\left( x \right) = h\left( { - x} \right)$ã€‚è®¾ç»™å®šæ•°æ®é›†$T={\left( {x_1},{y_1} \right),\left( {x_2},{y_2} \right),â€¦,\left( {x_N},{y_N} \right)}$ã€‚å…¶ä¸­${y_1} = 1,{y_2} =  - 1,â€¦,{y_N} =  - 1$ã€‚<br />
â€ƒä¼¼ç„¶å‡½æ•°ä¸º</p>

<script type="math/tex; mode=display">\begin{equation}
L\left( h \right) = P\left( {x_1} \right)h\left( {x_1} \right) \times P\left( {x_2} \right)\left( {1 - h\left( {x_2} \right)} \right) \times ... \times P\left( {x_N} \right)\left( {1 - h\left( {x_N} \right)} \right)
\end{equation}</script>

<p>â€ƒåœ¨ä¸Šå¼ä¸­ï¼Œ$P\left( {x_1} \right),P\left( {x_2} \right),â€¦,P\left( {x_N} \right)$ä¸å‚æ•°$w$æ— å…³ã€‚ä¼¼ç„¶å‡½æ•°å¯ç®€åŒ–ä¸º</p>
<center>$$L\left( h \right) = h\left( {x_1} \right) \times \left( {1 - h\left( {x_2} \right)} \right) \times ... \times \left( {1 - h\left( {x_N} \right)} \right)$$</center>

<p>â€ƒå³</p>

<script type="math/tex; mode=display">\begin{equation}
L\left( h \right) = \prod\limits_{i = 1}^N {h\left( {y_i}{x_i} \right)}
\end{equation}</script>

<p>â€ƒæ±‚è§£$w$æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°</p>

<script type="math/tex; mode=display">\begin{equation}
\mathop {\max }\limits_W likelihood\left( w \right) \propto \prod\limits_{i = 1}^N {\theta \left( {y_i}{w^T}{x_i} \right)}
\end{equation}</script>

<p>â€ƒå³</p>

<script type="math/tex; mode=display">\begin{equation}
\mathop {\max }\limits_w \log \prod\limits_{i = 1}^N {\theta \left( {y_i}{w^T}{x_i} \right)} 
\end{equation}</script>

<p>â€ƒæŸå¤±å‡½æ•°ä¸ºä¼¼ç„¶å‡½æ•°çš„ç›¸åæ•°</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
E\left( w \right) &= \sum\limits_{i = 1}^N { - \log \theta \left( {y_i}{w^T}{x_i} \right)}\\
&= \sum\limits_{i = 1}^N {\log \left( {1 + \exp \left( { - {y_i}{w^T}{x_i}} \right)} \right)} 
\end{align} %]]></script>

<p>â€ƒåœ¨ä¸Šè¿°å…¬å¼ä¸­ï¼Œå…¬å¼(9) $err\left( {w,x,y} \right) = {\left[ {\log \left( {1 + \exp \left( {w^T {x_i}} \right)} \right) - {y_i}\left( {w^T {x_i}} \right)} \right]}$å’Œå…¬å¼(15) $err\left( {w,x,y} \right) = \log \left( {1 + \exp \left( { - yw^Tx} \right)} \right)$ä¸ºä¸¤ç§å½¢å¼çš„<strong>äº¤å‰ç†µæŸå¤±(cross-entropy loss)</strong>ã€‚</p>

<h3 id="ä¸¤ç§æŸå¤±å‡½æ•°åˆ†æ">ä¸¤ç§æŸå¤±å‡½æ•°åˆ†æ</h3>
<p>â€ƒåœ¨æèˆªçš„ä¹¦ä¸­ï¼ŒlogisticæŸå¤±å‡½æ•°ä¸º</p>

<script type="math/tex; mode=display">\begin{equation}
E_1\left( w \right) = {\log \left( {1 + \exp \left( {w^T{x_i}} \right)} \right) - {y_i}\left( {w^T{x_i}} \right)}
\end{equation}</script>

<p>â€ƒåœ¨æ—è½©ç”°è€å¸ˆçš„è¯¾ç¨‹ä¸­ï¼ŒlogisticæŸå¤±å‡½æ•°ä¸º</p>

<script type="math/tex; mode=display">\begin{equation}
E_2\left( w \right) = {\log \left( {1 + \exp \left( { - {y_i}{w^T}{x_i}} \right)} \right)} 
\end{equation}</script>

<p>â€ƒå½“yä¸ºè´Ÿï¼Œå³$y_1=0$,$y_2=-1$æ—¶</p>

<script type="math/tex; mode=display">\begin{equation}
E_1\left( w \right) = {\log \left( {1 + \exp \left( {w^T}{x_i} \right)} \right)} 
\end{equation}</script>

<script type="math/tex; mode=display">E_2\left( w \right) = {\log \left( {1 + \exp \left( {w^T}{x_i} \right)} \right)}</script>

<p>â€ƒå½“yä¸ºæ­£ï¼Œå³$y_1=1$,$y_2=1$æ—¶</p>

<script type="math/tex; mode=display">\begin{equation}
E_1\left( w \right) = {\log \left( {1 + \exp \left( -{w^T}{x_i} \right)} \right)} 
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
E_2\left( w \right) = {\log \left( {1 + \exp \left( -{w^T}{x_i} \right)} \right)} 
\end{equation}</script>

<p>â€ƒæ‰€ä»¥ä¸¤ç§æŸå¤±å‡½æ•°æ˜¯ç­‰ä»·çš„ï¼Œä½†ä»å½¢å¼ä¸Šæ¥çœ‹ç¬¬äºŒç§æ›´åŠ ä¼˜ç¾ã€‚</p>

<h1 id="æŸå¤±å‡½æ•°æ¢¯åº¦">æŸå¤±å‡½æ•°æ¢¯åº¦</h1>
<h3 id="ç¬¬ä¸€ç§æ¢¯åº¦">ç¬¬ä¸€ç§æ¢¯åº¦</h3>

<script type="math/tex; mode=display">\begin{equation}
E_1\left( w \right) = {\log \left( {1 + \exp \left( {w^T{x_i}} \right)} \right) - {y_i}\left( {w^T{x_i}} \right)}
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
\frac{\partial {E_1}\left( w \right)}{\partial w} = \sum\limits_{i = 1}^N 
{\left[ \frac{\exp \left( {w^T}{x_i} \right)}{1 + \exp \left( {w^T}{x_i} \right)}{x_i} - {y_i}{x_i} \right]} 
\end{equation}</script>

<h3 id="ç¬¬äºŒç§æ¢¯åº¦">ç¬¬äºŒç§æ¢¯åº¦</h3>

<script type="math/tex; mode=display">\begin{equation}
E_2\left( w \right) = {\log \left( {1 + \exp \left( { - {y_i}{w^T}{x_i}} \right)} \right)} 
\end{equation}</script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\frac{\partial {E_2}\left( w \right)}{\partial w} &= \sum\limits_{i = 1}^N {\frac{\exp \left( { - {y_i}{w^T}{x_i}} \right)}{1 + \exp \left( { - {y_i}{w^T}{x_i}} \right)}} \left( { - {y_i}{x_i}} \right)\\
&= \sum\limits_{i = 1}^N {\theta \left( { - {y_i}{w^T}{x_i}} \right)} \left( { - {y_i}{x_i}} \right)
\end{align} %]]></script>

<p>â€ƒç¬¬äºŒç§å½¢å¼æ›´åŠ ä¼˜é›…ã€‚</p>

<h1 id="å†³ç­–å‡½æ•°">å†³ç­–å‡½æ•°</h1>
<p>â€ƒLRå›å½’çš„é¢„æµ‹å€¼åœ¨(0, 1)åŒºé—´å†…ï¼Œæ ¹æ®å…·ä½“çš„é—®é¢˜å¯ä»¥è®¾ç½®ä¸åŒçš„é˜ˆå€¼ï¼Œä¸€èˆ¬ä»¥0.5ä¸ºé˜ˆå€¼ï¼Œå³</p>

<center>${y_{pred}} = 1$, if $h\left( x \right) = P\left( {y = 1\left| x \right.} \right) &gt; 0.5$</center>

<p>â€ƒæ³¨æ„è¿™é‡Œ$h\left( x \right) = 0.5$æ—¶ï¼Œ$w^Tx=0$,å³å¯¹æ•°å‡ ç‡ä¸º0ï¼Œå‡ ç‡ä¸º1ï¼Œè¡¨ç¤ºäº‹ä»¶å‘ç”Ÿå’Œä¸å‘ç”Ÿçš„æ¦‚ç‡ç›¸ç­‰ï¼Œåˆšå¥½ä¸ºå†³ç­–è¾¹ç•Œã€‚</p>
:ET